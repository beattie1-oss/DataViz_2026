panel.grid.minor.x = element_blank(),
panel.spacing.x = unit(1, "lines"),
strip.text = element_text(size = 10, face = "bold")
)+
scale_fill_brewer(palette = "Set1")
ggplot(NCSS_groups,
aes(x = trad12, y = n_members, fill = trad6)) +
geom_col(position= position_dodge2(width= 0.7), alpha = 0.8) +
facet_grid(. ~ trad6, scales = "free_x", space = "free_x") + #free x scales makes facets only have cateogories in it
scale_y_continuous(breaks = seq(0,25000,5000),limits = c(0,28000)) + #limit outliers out to see distributions
guides(fill = "none") +
labs(y = "Number of Official Members in 2022",
x = "Religious Classification",
fill = "none") +
theme_ellen() +
theme(
axis.text.x = element_text(size = 9, angle = 35, hjust = 1),
legend.position = "bottom",
panel.background = element_blank(),
panel.border = element_blank(),
panel.spacing = unit(0, "lines") ,#remove visual seperation
panel.grid.major.x = element_blank(),#keep only y so looks continuous
panel.grid.minor.x = element_blank(),
panel.spacing.x = unit(1, "lines"),
strip.text = element_text(size = 11, face = "bold")
)+
scale_fill_brewer(palette = "Set1")
ggplot(NCSS_groups,
aes(x = trad12, y = n_members, fill = trad6)) +
geom_col(position= position_dodge2(width= 0.7), alpha = 0.8) +
facet_grid(. ~ trad6, scales = "free_x", space = "free_x") + #free x scales makes facets only have cateogories in it
scale_y_continuous(breaks = seq(0,25000,5000),limits = c(0,28000)) + #limit outliers out to see distributions
guides(fill = "none") +
labs(y = "Number of Official Members in 2022",
x = "Religious Classification") +
theme_ellen() +
theme(
axis.text.x = element_text(size = 8, angle = 35, hjust = 1),
legend.position = "bottom",
panel.background = element_blank(),
panel.border = element_blank(),
panel.spacing = unit(0, "lines") ,#remove visual seperation
panel.grid.major.x = element_blank(),#keep only y so looks continuous
panel.grid.minor.x = element_blank(),
panel.spacing.x = unit(1, "lines"),
strip.text = element_text(size = 11, face = "bold")
) +
scale_fill_brewer(palette = "Set1")
summary(NCSS$n_members) #can see NA's
NCSS_groups <- NCSS %>%
filter(!is.na(n_members), year == "2022")# %>%
pdf("PS02_DV2.pdf")
ggplot(NCSS_groups,
aes(x = trad12, y = n_members, fill = trad6)) +
geom_col(position= position_dodge2(width= 0.7), alpha = 0.8) +
facet_grid(. ~ trad6, scales = "free_x", space = "free_x") + #free x scales makes facets only have cateogories in it
scale_y_continuous(breaks = seq(0,25000,5000),limits = c(0,28000)) + #limit outliers out to see distributions
guides(fill = "none") +
labs(y = "Number of Official Members in 2022",
x = "Religious Classification") +
theme_ellen() +
theme(
axis.text.x = element_text(size = 8, angle = 35, hjust = 1),
legend.position = "bottom",
panel.background = element_blank(),
panel.border = element_blank(),
panel.spacing = unit(0, "lines") ,#remove visual seperation
panel.grid.major.x = element_blank(),#keep only y so looks continuous
panel.grid.minor.x = element_blank(),
panel.spacing.x = unit(1, "lines"),
strip.text = element_text(size = 11, face = "bold")
) +
scale_fill_brewer(palette = "Set1")
dev.off()
ggplot(NCSS_groups,
aes(x = trad12, y = n_members, fill = trad6)) +
geom_col(position= position_dodge2(width= 0.5), alpha = 0.8) + #dodge2 for histogram look
facet_grid(. ~ trad6, scales = "free_x", space = "free_x") + #free x scales makes facets only have cateogories in it
scale_y_continuous(breaks = seq(0,25000,5000),limits = c(0,28000)) + #limit outliers out to see distributions
guides(fill = "none") + #looked cluttered and groups easily read
labs(y = "Number of Official Members in 2022",
x = "Religious Classification") +
theme_ellen() +
theme(
axis.text.x = element_text(size = 8, angle = 35, hjust = 1),
panel.background = element_blank(),
panel.border = element_blank(), #remove box
panel.spacing = unit(0, "lines") ,#remove visual seperation
panel.grid.major.x = element_blank(),#keep only y so looks continuous
panel.grid.minor.x = element_blank(),
panel.spacing.x = unit(1, "lines"), #add space between facet subplots
strip.text = element_text(size = 11, face = "bold") #facet title font
) +
scale_fill_brewer(palette = "Set1") #colour
NCSS_region <- NCSS %>%
filter(!is.na(region), !is.na(income), year == "2022") %>% #filter out NA's and specify year
filter(income < quantile(income, 0.9))
ggplot(NCSS_region, aes(x= income , y = region , fill= region, height = after_stat(count))) +
geom_density_ridges(stat = "density", adjust = 0.6, scale = 1, alpha = 0.7) +
labs(y = "Region",
x = "Congregation Income",
fill = "Region") +
theme_ridges() +
scale_fill_brewer(palette="Set3") +
theme(
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none"
)
ggplot(NCSS_region, aes(x= income , y = region , fill= region, height = after_stat(count))) +
geom_density_ridges(stat = "density", adjust = 0.6, scale = 1, alpha = 0.7) +
labs(y = "Region",
x = "Congregation Income",
fill = "Region") +
theme_ellen() +
theme_ridges() +
scale_fill_brewer(palette="Set3") +
theme(
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none"
)
ggplot(NCSS_region, aes(x= income , y = region , fill= region, height = after_stat(count))) +
geom_density_ridges(stat = "density", adjust = 0.6, scale = 1, alpha = 0.7) +
labs(y = "Region",
x = "Congregation Income",
fill = "Region") +
theme_ellen() +
scale_fill_brewer(palette="Set3") +
theme(
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none"
)
ggplot(NCSS_region, aes(x= income , y = region , fill= region)) +
geom_density_ridges(stat = "density",
adjust = 0.6,
scale = 1,
alpha = 0.7,
rel_min_height = 0.005,#hight of distribution
linewidth = 0.4) +
labs(y = "Region",
x = "Congregation Income",
fill = "Region") +
theme_ellen() +
scale_fill_brewer(palette="Set3") +
theme(
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none"
)
rlang::last_trace()
ggplot(NCSS_region, aes(x= income , y = region , fill= region)) +
geom_density_ridges(stat = "density",
adjust = 0.6,
scale = 1,
alpha = 0.7,
rel_min_height = 0.005,#hight of distribution
linewidth = 0.4) +
labs(y = "Region",
x = "Congregation Income",
fill = "Region") +
theme_ellen() +
scale_fill_brewer(palette="Set3") +
theme(
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none"
)
ggplot(NCSS_region, aes(x= income , y = region , fill= region, height = after_stat(count))) +
geom_density_ridges(stat = "density",
adjust = 0.6,
scale = 1,
alpha = 0.7,
rel_min_height = 0.005,#hight of distribution
linewidth = 0.4) +
labs(y = "Region",
x = "Congregation Income",
fill = "Region") +
theme_ellen() +
scale_fill_brewer(palette="Set3") +
theme(
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none"
)
ggplot(NCSS_region, aes(x= income , y = region , fill= region, height = after_stat(count))) +
geom_density_ridges(stat = "density",
adjust = 0.5,
scale = 1,
alpha = 0.7,
rel_min_height = 0.005,#hight of distribution
linewidth = 0.4) +
labs(y = "Region",
x = "Congregation Income",
fill = "Region") +
theme_ellen() +
scale_fill_brewer(palette="Set3") +
theme(
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none"
)
ggplot(NCSS_region, aes(x= income , y = region , fill= region, height = after_stat(count))) +
geom_density_ridges(stat = "density",
adjust = 0.5,
scale = 1,
alpha = 0.7,
rel_min_height = 0.005,#hight of distribution
linewidth = 0.4) +
labs(y = "Region",
x = "Congregation Income",
fill = "Region") +
theme_ridges() +
scale_fill_brewer(palette="Set3") +
theme(
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none",
)
ggplot(NCSS_region, aes(x= income , y = region , fill= region, height = after_stat(count))) +
geom_density_ridges(stat = "density",
adjust = 0.5,
scale = 1,
alpha = 0.7,
rel_min_height = 0.005,#hight of distribution
linewidth = 0.4) +
labs(y = "Region",
x = "Congregation Income",
fill = "Region") +
theme_ridges() +
scale_fill_brewer(palette="Set3") +
theme(
element_text(family = "serif"),
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none",
)
ggplot(NCSS_region, aes(x= income , y = region , fill= region, height = after_stat(count))) +
geom_density_ridges(stat = "density",
adjust = 0.5,
scale = 1,
alpha = 0.7,
rel_min_height = 0.005,#hight of distribution
linewidth = 0.4) +
labs(y = "Region",
x = "Congregation Income",
fill = "Region") +
theme_ridges() +
scale_fill_brewer(palette="Set3") +
theme(
font = element_text(family = "serif"),
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none",
)
ggplot(NCSS_region, aes(x= income , y = region , fill= region, height = after_stat(count))) +
geom_density_ridges(stat = "density",
adjust = 0.5,
scale = 1,
alpha = 0.7,
rel_min_height = 0.005,#hight of distribution
linewidth = 0.4) +
labs(y = "Region",
x = "Congregation Income",
fill = "Region") +
theme_ridges() +
scale_fill_brewer(palette="Set3") +
theme(
text = text(element_text(family = "serif")),
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none",
)
ggplot(NCSS_region, aes(x= income , y = region , fill= region, height = after_stat(count))) +
geom_density_ridges(stat = "density",
adjust = 0.5,
scale = 1,
alpha = 0.7,
rel_min_height = 0.005,#hight of distribution
linewidth = 0.4) +
labs(y = "Region",
x = "Congregation Income",
fill = "Region") +
theme_ridges() +
scale_fill_brewer(palette="Set3") +
theme(
text = text(element_text(family = "serif")),
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none"
)
NCSS_region <- NCSS %>%
filter(!is.na(region), !is.na(income), year == "2022") %>% #filter out NA's and specify year
filter(income < quantile(income, 0.9))
pdf("PS02_DV3.pdf")
ggplot(NCSS_region, aes(x= income , y = region , fill= region, height = after_stat(count))) +
geom_density_ridges(stat = "density",
adjust = 0.5,
scale = 1,
alpha = 0.7,
rel_min_height = 0.005,#hight of distribution
linewidth = 0.4) +
labs(y = "Region",
x = "Congregation Income",
fill = "Region") +
theme_ridges() +
scale_fill_brewer(palette="Set3") +
theme(
text = text(element_text(family = "serif")),
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none"
)
ggplot(NCSS_region, aes(x= income , y = region , fill= region)) +
geom_density_ridges(
adjust = 0.5,
scale = 1,
alpha = 0.7) +
labs(y = "Region", x = "Congregation Income", fill = "Region") +
theme_ridges() +
scale_fill_brewer(palette="Set3") +
theme(
text = text(element_text(family = "serif")),
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none"
)
ggplot(NCSS_region, aes(x= income , y = factor(region) , fill= region)) +
geom_density_ridges(
adjust = 0.5,
scale = 1,
alpha = 0.7) +
labs(y = "Region", x = "Congregation Income", fill = "Region") +
theme_ridges() +
scale_fill_brewer(palette="Set3") +
theme(
text = text(element_text(family = "serif")),
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none"
)
ggplot(NCSS_region, aes(x= income , y = region , fill= region, height = after_stat(count))) +
geom_density_ridges(stat = "density",
adjust = 0.5,
scale = 1,
alpha = 0.7,
rel_min_height = 0.005,#hight of distribution
linewidth = 0.4) +
labs(y = "Region",
x = "Congregation Income",
fill = "Region") +
theme_ellen() +
scale_fill_brewer(palette="Set3") +
theme(
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none"
)
ggplot(NCSS_region, aes(x= income , y = region , fill= region))+ #height = after_stat(count))) +
geom_density_ridges(#stat = "density",
adjust = 0.5,
scale = 1,
alpha = 0.7,
rel_min_height = 0.005,#hight of distribution
linewidth = 0.4) +
labs(y = "Region",
x = "Congregation Income",
fill = "Region") +
theme_ellen() +
scale_fill_brewer(palette="Set3") +
theme(
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none"
)
ggplot(NCSS_region, aes(x= income , y = region , fill= region))+ #height = after_stat(count))) +
geom_density_ridges(stat = "identity",
scale = 1,
alpha = 0.7,
rel_min_height = 0.005,#hight of distribution
linewidth = 0.4) +
labs(y = "Region",
x = "Congregation Income",
fill = "Region") +
theme_ellen() +
scale_fill_brewer(palette="Set3") +
theme(
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none"
)
ggplot(NCSS_region, aes(x= income , y = region , fill= region)) +
geom_density_ridges(stat = "denstity",
scale = 1,
alpha = 0.7,
rel_min_height = 0.005,#hight of distribution
linewidth = 0.4) +
labs(y = "Region",
x = "Congregation Income",
fill = "Region") +
theme_ellen() +
scale_fill_brewer(palette="Set3") +
theme(
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none"
)
ggplot(NCSS_region, aes(x= income , y = region , fill= region)) +
geom_density_ridges(stat = "density",
scale = 1,
alpha = 0.7,
rel_min_height = 0.005,#hight of distribution
linewidth = 0.4) +
labs(y = "Region",
x = "Congregation Income",
fill = "Region") +
theme_ellen() +
scale_fill_brewer(palette="Set3") +
theme(
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none"
)
ggplot(NCSS_region, aes(x= income , y = region , fill= region)) +
geom_density_ridges(stat = "density",
scale = 1,
alpha = 0.7,
#hight of distribution
linewidth = 0.4) +
labs(y = "Region",
x = "Congregation Income",
fill = "Region") +
theme_ellen() +
scale_fill_brewer(palette="Set3") +
theme(
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none"
)
ggplot(NCSS_region, aes(x= income , y = region , fill= region)) +
geom_density_ridges(stat = "density",
alpha = 0.7,
#hight of distribution
linewidth = 0.4) +
labs(y = "Region",
x = "Congregation Income",
fill = "Region") +
theme_ellen() +
scale_fill_brewer(palette="Set3") +
theme(
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none"
)
ggplot(NCSS_region, aes(x= income , y = region , fill= region)) +
geom_density_ridges(alpha = 0.7,
#hight of distribution
linewidth = 0.4) +
labs(y = "Region",
x = "Congregation Income",
fill = "Region") +
theme_ellen() +
scale_fill_brewer(palette="Set3") +
theme(
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none"
)
ggplot(NCSS_region, aes(x= income , y = region , fill= region)) +
geom_density_ridges(alpha = 0.7,
#hight of distribution
linewidth = 0.4) +
labs(y = "Region",  x = "Congregation Income",
fill = "Region") +
theme_ellen() +
scale_fill_brewer(palette="Set3") +
theme(
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none"
)
ggplot(NCSS_region, aes(x= income , y = region , fill= region)) +
geom_density_ridges(alpha = 0.7,
bandwidth = 1000
linewidth = 0.4) +
ggplot(NCSS_region, aes(x= income , y = region , fill= region)) +
geom_density_ridges(alpha = 0.7,
bandwidth = 1000,
linewidth = 0.4) +
labs(y = "Region",  x = "Congregation Income",
fill = "Region") +
theme_ellen() +
scale_fill_brewer(palette="Set3") +
theme(
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none"
)
ggplot(NCSS_region, aes(x= income , y = region , fill= region)) +
geom_density_ridges(alpha = 0.7,
bandwidth = 1000,
linewidth = 0.4) +
labs(y = "Region",  x = "Congregation Income",
fill = "Region") +
theme_ellen() +
scale_fill_brewer(palette="Set3") +
theme(
axis.text.y = element_text(size = 8),
axis.text.x = element_text(size = 10, angle = 0, hjust = 1),
legend.position = "none"
)
